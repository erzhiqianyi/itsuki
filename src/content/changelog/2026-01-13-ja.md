---
title: "Photos 2.0: アルバム化へのリファクタリングとインタラクションの向上"
date: "2026-01-12"
version: "v1.0.5"
lang: "ja"
type: "feat"
---
今回のアップデートは、写真モジュール（/photos）の徹底的なリファクタリングであり、「単一画像の共有」から完全な「アルバム体験」への移行を目指しています。

✨ 新機能 (Features)

アルバムモード (Album Mode): 単一の Markdown ファイルで複数の画像（images 配列）を定義できるようになり、詳細ページでは高性能なウォーターフォールレイアウトで自動的にレンダリングされます。

ウォーターフォールコンポーネント (Masonry Gallery):

React アイランドアーキテクチャを導入し、画像レンダリングを担当させました。

aspect-ratio 技術を利用して、CLS（レイアウトシフト）ゼロの読み込み体験を実現しました。

画像を強制的にトリミングすることなく、元の比率で表示することをサポートします。

没入型ライトボックス (Lightbox):

画像をクリックすると全画面表示モードに入ります。

キーボード（←/→/Esc）およびタッチジェスチャーによるナビゲーションをサポートします。

画像のタイトルとインデックス番号を表示します。

新しいリストページ:

/photos をカードスタイルのグリッドレイアウトにリファクタリングしました。

アルバムの表紙（Cover）または最初の画像を自動的にサムネイルとして抽出します。

撮影日時、場所、およびアルバム内の画像数の統計を表示します。

🐛 修正と改善 (Fixes & Improvements)

ホームページギャラリーの修正:

新しいアルバムデータ構造に合わせて、ホームページのカルーセルコンポーネントを同期しました。

ギャラリー画像をクリックしても詳細ページにジャンプしない問題を修正しました。

多言語タイトルによる React レンダリングクラッシュを防ぐための防御的なプログラミングを追加しました。

ナビゲーションの最適化:

アルバム詳細ページのトップ（ヒーローエリア）に目立つ「リストに戻る」ボタンを追加し、閲覧の連続性を向上させました。

データの互換性:

後方互換ロジックを実装しました。古いバージョンの Markdown（cover フィールドのみ）も、単一画像のアルバムとして正常に表示されます。

🛠️ 技術的な詳細

React 統合: Astro ページ内で MasonryGallery コンポーネントを部分的にハイドレーション（client:load）しました。

防御的コーディング: 特定のエッジケースにおける date.toISOString の型エラーを修正しました。

UI システム: Catppuccin Mocha 配色スキームに完全に準拠し、すりガラス（Backdrop Blur）効果を最適化しました。
